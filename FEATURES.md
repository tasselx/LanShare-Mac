# LanShare - 功能特性

## ✨ 核心功能

### 📁 文件分享

- **支持任意文件类型** - 无限制，支持所有格式
  - 文档：PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT, MD
  - 图片：JPG, PNG, GIF, BMP, SVG, HEIC
  - 视频：MP4, MOV, AVI, MKV, M4V
  - 音频：MP3, WAV, AAC, FLAC, M4A
  - 压缩包：ZIP, RAR, 7Z, TAR, GZ
  - 应用程序：APP, DMG, PKG
  - 其他：任意文件格式

- **多种分享方式**
  - 拖放文件到窗口
  - 点击按钮选择文件
  - 支持大文件（无大小限制）

### 🔗 分享链接

- **MD5 短链接** - 简洁易记
  - 格式：`http://192.168.1.100:8080/a1b2c3d4.pdf`
  - 自动添加文件后缀名
  - 8位 MD5 哈希值

- **一键复制** - 快速分享
  - 复制链接按钮
  - Toast 提示反馈
  - 支持文本选择

### 📱 二维码分享

- **自动生成二维码**
  - 点击按钮显示弹窗
  - 180x180 高清二维码
  - 延迟加载，提升性能

- **扫码下载**
  - 手机扫码即可下载
  - 平板扫码即可下载
  - 跨平台支持

### 🌐 网页访问

- **文件列表页面**
  - 美观的网页界面
  - 显示所有共享文件
  - 支持批量浏览

- **网页功能**
  - 查看文件信息（名称、大小）
  - 复制分享链接
  - 查看二维码
  - 直接下载文件

### ⚡ 限速传输

- **全局速度限制**
  - 可开启/关闭限速功能
  - 自定义传输速度
  - 实时显示当前限速设置

- **速度预设**
  - 512 KB/s - 慢速传输
  - 1 MB/s (1024 KB/s) - 标准速度
  - 5 MB/s (5120 KB/s) - 快速传输
  - 10 MB/s (10240 KB/s) - 高速传输

- **自定义速度**
  - 手动输入任意速度值
  - 单位：KB/s
  - 实时生效

- **传输控制**
  - 分块传输
  - 精确速度控制
  - 不影响其他网络应用

### 🎨 用户界面

- **原生 macOS 设计**
  - SwiftUI 构建
  - 现代化界面
  - 流畅动画

- **状态显示**
  - 服务运行状态
  - 本机 IP 地址
  - 共享文件数量
  - 限速状态和速度

- **Toast 提示**
  - 黑底白字居中显示
  - 2秒自动消失
  - 缩放淡入动画

## 🔒 安全特性

### 权限控制

- **沙盒应用** - 系统级安全保护
- **用户选择文件** - 仅访问用户明确选择的文件
- **局域网限制** - 仅在局域网内可访问
- **无需密码** - 简化使用流程（可扩展）

### 网络安全

- **HTTP 服务器** - 轻量级实现
- **端口配置** - 默认 8080（可修改）
- **本地服务** - 不连接外网
- **临时分享** - 关闭应用即停止分享

## 📊 技术特性

### 性能优化

- **延迟加载** - 二维码按需生成
- **异步处理** - 不阻塞主线程
- **内存管理** - 自动释放资源
- **限速传输** - 分块发送，精确控制速度
- **带宽管理** - 可根据网络环境调整传输速度

### 兼容性

- **macOS 13.0+** - 支持最新系统
- **跨平台接收** - 任何设备浏览器都能访问
  - iOS / iPadOS
  - Android
  - Windows
  - Linux
  - macOS

### 文件处理

- **无大小限制** - 支持任意大小文件
- **保持原始文件名** - 下载时使用原文件名
- **MIME 类型识别** - 自动设置正确的内容类型
- **分块传输** - 支持限速时的分块发送
- **断点续传** - （计划中）支持大文件的断点续传

## 🎯 使用场景

### 个人使用

- 手机和电脑之间传文件
- 平板和电脑之间传文件
- 多台电脑之间传文件

### 团队协作

- 会议室快速分享文件
- 办公室内部文件传输
- 临时文件分享

### 家庭使用

- 家庭成员之间传照片
- 分享视频给家人
- 传输文档给家人

## 🚀 即将推出

- [x] 限速传输功能
- [ ] 文件夹分享
- [ ] 密码保护
- [ ] 分享链接有效期
- [ ] 下载统计
- [ ] 单文件独立限速
- [ ] 自定义端口
- [ ] HTTPS 支持
- [ ] 批量文件上传
- [ ] 拖放多个文件
- [ ] 断点续传

## 💡 提示

### 最佳实践

1. **确保同一网络** - 所有设备连接同一 WiFi
2. **防火墙设置** - 允许应用访问网络
3. **保持应用运行** - 分享期间不要关闭应用
4. **使用短链接** - 更容易分享和记忆

### 故障排除

- **无法访问？** 检查防火墙设置
- **找不到设备？** 确认在同一局域网
- **下载失败？** 确保应用正在运行
- **二维码无法扫描？** 尝试调整距离和光线

## 📝 技术细节

### 文件类型支持

应用使用 `UTType.item` 作为文件选择器的类型，这是 UniformTypeIdentifiers 框架中的基础类型，包含所有文件类型。

```swift
.fileImporter(
    isPresented: $showFilePicker,
    allowedContentTypes: [.item],  // 支持所有文件类型
    allowsMultipleSelection: false
)
```

### 权限配置

应用使用以下权限：

- `com.apple.security.files.user-selected.read-write` - 读取用户选择的文件
- `com.apple.security.network.server` - 启动 HTTP 服务器
- `com.apple.security.network.client` - 网络通信

### HTTP 服务器

- 使用 Network Framework 实现
- 支持 GET 请求
- 自动设置 Content-Type
- 支持大文件传输
- 支持限速传输

### 限速实现

应用使用分块传输和定时延迟实现精确的速度控制：

```swift
// 分块发送，每秒发送指定大小的数据块
let chunkSize = speedLimitKBps * 1024 // 转换为字节
let delayBetweenChunks = 1.0 // 每秒发送一次
```

限速机制：
- 将文件数据分成多个数据块
- 每个数据块大小 = 限速值（KB/s）× 1024 字节
- 每秒发送一个数据块
- 通过 DispatchQueue 精确控制发送间隔
